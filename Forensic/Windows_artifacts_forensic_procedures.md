# Windows artifacts and forensic procedures
## NTFS

```
File Metadata: NTFS stores extensive metadata for each file, including creation time, modification time, access time, and attribute information (such as read-only, hidden, or system file attributes).
Analyzing these timestamps can help establish timelines and reconstruct user activities.

MFT Entries: The Master File Table (MFT) is a crucial component of NTFS that stores metadata for all files and directories on a volume. Examining MFT entries provides insights into file names, sizes,
timestamps, and data storage locations. When files are deleted, their MFT entries are marked as available, but the data may remain on the disk until overwritten.
File Slack and Unallocated Space: Unallocated space on an NTFS volume may contain remnants of deleted files or fragments of data. File slack refers to the unused portion of a cluster that may contain data from a previous file.
Digital forensic tools can help recover and analyze data from these areas.

File Signatures: File headers and signatures can be useful in identifying file types even when file extensions have been changed or obscured. This information is critical for reconstructing the types of files present on a system.

USN Journal: The Update Sequence Number (USN) Journal is a log maintained by NTFS to record changes made to files and directories. Forensic investigators can analyze the USN Journal to track file modifications, deletions, and renames.

LNK Files: Windows shortcut files (LNK files) contain information about the target file or program, as well as timestamps and metadata. These files can provide insights into recently accessed files or executed programs.
Prefetch Files: Prefetch files are generated by Windows to improve the startup performance of applications. These files can indicate which programs have been run on the system and when they were last executed.
Registry Hives: While not directly related to the file system, Windows Registry hives contain important configuration and system information. Malicious activities or unauthorized changes can leave traces in the registry,
 which forensic investigators analyze to understand system modifications.

Shellbags: Shellbags are registry entries that store folder view settings, such as window positions and sorting preferences. Analyzing shellbags can reveal user navigation patterns and potentially identify accessed folders.

Thumbnail Cache: Thumbnail caches store miniature previews of images and documents. These caches can reveal files that were recently viewed, even if the original files have been deleted.

Recycle Bin: The Recycle Bin contains files that have been deleted from the file system. Analyzing the Recycle Bin can help recover deleted files and provide insights into user actions.

Alternate Data Streams (ADS): ADS are additional streams of data associated with files. Malicious actors may use ADS to hide data, and forensic investigators need to examine these streams to ensure a comprehensive analysis.

Volume Shadow Copies: NTFS supports Volume Shadow Copies, which are snapshots of the file system at different points in time. These copies can be valuable for data recovery and analysis of changes made over time.
Security Descriptors and ACLs: Access Control Lists (ACLs) and security descriptors determine file and folder permissions. Analyzing these artifacts helps understand user access rights and potential security breaches.
```

## Windows Event Logs
```
C:\Windows\System32\winevt\logs
```

## Execution Artifacts
traces and evidence left behind on a Windows operating system when programs and processes are executed.

| Artifact             | Location/Registry Key                                      | Data Stored                                            |
|----------------------|------------------------------------------------------------|--------------------------------------------------------|
| Prefetch Files       | C:\Windows\Prefetch                                       | Metadata about executed applications (file paths, timestamps, execution count)   |
| Shimcache            | Registry: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache | Program execution details (file paths, timestamps, flags) |
| Amcache              | C:\Windows\AppCompat\Programs\Amcache.hve (Binary Registry Hive) | Application details (file paths, sizes, digital signatures, timestamps)  |
| UserAssist           | Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist | Executed program details (application names, execution counts, timestamps) |
| RunMRU Lists         | Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU | Recently executed programs and their command lines |
| Jump Lists           | User-specific folders (e.g., %AppData%\Microsoft\Windows\Recent) | Recently accessed files, folders, and tasks associated with applications |
| Shortcut (LNK) Files | Various locations (e.g., Desktop, Start Menu) | Target executable, file paths, timestamps, user interactions |
| Recent Items         | User-specific folders (e.g., %AppData%\Microsoft\Windows\Recent) | Recently accessed files |
| Windows Event Logs   | C:\Windows\System32\winevt\Logs | Various event logs containing process creation, termination, and other events |


## keys used for persistence

```
Example of Autorun keys used for persistence:

Run/RunOnce Keys

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\
Keys used by WinLogon Process

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
Startup Keys

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User
```

##  Schtasks
```
C:\Windows\System32\Tasks
```
## Services
```
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services
```









